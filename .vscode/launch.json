{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "ğŸš€ é‡æ–°ç¼–è¯‘å¹¶å¯åŠ¨",
            "type": "node",
            "request": "launch",
            "runtimeExecutable": "powershell.exe",
            "runtimeArgs": [
                "-NoProfile",
                "-ExecutionPolicy",
                "Bypass",
                "-Command",
                "Write-Host 'æ£€æŸ¥ SQLx ç¼“å­˜...' -ForegroundColor Cyan; if (-not (Test-Path '.sqlx')) { Write-Host '[è­¦å‘Š] SQLx ç¼“å­˜ä¸å­˜åœ¨ï¼' -ForegroundColor Yellow; Write-Host 'é¦–æ¬¡æ„å»ºéœ€è¦å…ˆç”Ÿæˆ SQLx ç¼“å­˜ï¼Œè¯·é€‰æ‹©: ğŸ“¦ é‡æ–°ç”Ÿæˆ SQLx ç¼“å­˜' -ForegroundColor Yellow; exit 1 } else { Write-Host '[OK] SQLx ç¼“å­˜å·²å­˜åœ¨' -ForegroundColor Green }; Write-Host 'åœæ­¢æ—§å®¹å™¨...' -ForegroundColor Cyan; docker compose -f docker-compose-dev.yml --env-file .env down; Write-Host 'é‡æ–°ç¼–è¯‘å¹¶å¯åŠ¨æ ¸å¿ƒæœåŠ¡ (ä¸å« AI)...' -ForegroundColor Cyan; Write-Host 'æ³¨æ„: é¦–æ¬¡ç¼–è¯‘å¯èƒ½éœ€è¦ 10-30 åˆ†é’Ÿ' -ForegroundColor Yellow; docker compose -f docker-compose-dev.yml --env-file .env up -d --build postgres redis minio gotrue appflowy_cloud nginx; if ($LASTEXITCODE -eq 0) { Write-Host 'æœåŠ¡å¯åŠ¨æˆåŠŸï¼' -ForegroundColor Green; Write-Host 'è®¿é—®: http://localhost:8000/health' -ForegroundColor Cyan; Write-Host 'å·²æ’é™¤: AI æœåŠ¡, PgAdmin' -ForegroundColor Gray } else { Write-Host 'å¯åŠ¨å¤±è´¥ï¼ŒæŸ¥çœ‹æ—¥å¿—: docker compose -f docker-compose-dev.yml logs' -ForegroundColor Red }"
            ],
            "console": "integratedTerminal",
            "internalConsoleOptions": "neverOpen"
        },
        {
            "name": "ğŸ”„ ä»…é‡å¯æœåŠ¡ï¼ˆä¸é‡æ–°ç¼–è¯‘ï¼‰",
            "type": "node",
            "request": "launch",
            "runtimeExecutable": "powershell.exe",
            "runtimeArgs": [
                "-NoProfile",
                "-ExecutionPolicy",
                "Bypass",
                "-Command",
                "Write-Host 'åœæ­¢æœåŠ¡...' -ForegroundColor Cyan; docker compose -f docker-compose-dev.yml --env-file .env down; Write-Host 'å¯åŠ¨æ ¸å¿ƒæœåŠ¡ (ä¸å« AI)...' -ForegroundColor Cyan; docker compose -f docker-compose-dev.yml --env-file .env up -d postgres redis minio gotrue appflowy_cloud nginx; if ($LASTEXITCODE -eq 0) { Write-Host 'æœåŠ¡å¯åŠ¨æˆåŠŸï¼' -ForegroundColor Green; Write-Host 'è®¿é—®: http://localhost:8000/health' -ForegroundColor Cyan; Write-Host 'å·²æ’é™¤: AI æœåŠ¡, PgAdmin' -ForegroundColor Gray } else { Write-Host 'å¯åŠ¨å¤±è´¥ï¼ŒæŸ¥çœ‹æ—¥å¿—: docker compose -f docker-compose-dev.yml logs' -ForegroundColor Red }"
            ],
            "console": "integratedTerminal",
            "internalConsoleOptions": "neverOpen"
        },
        {
            "name": "ğŸ—‘ï¸ æ¸…ç©ºå¹¶é‡æ–°ç¼–è¯‘",
            "type": "node",
            "request": "launch",
            "runtimeExecutable": "powershell.exe",
            "runtimeArgs": [
                "-NoProfile",
                "-ExecutionPolicy",
                "Bypass",
                "-Command",
                "Write-Host 'æ£€æŸ¥ SQLx ç¼“å­˜...' -ForegroundColor Cyan; if (-not (Test-Path '.sqlx')) { Write-Host '[è­¦å‘Š] SQLx ç¼“å­˜ä¸å­˜åœ¨ï¼' -ForegroundColor Yellow; Write-Host 'é¦–æ¬¡æ„å»ºéœ€è¦å…ˆç”Ÿæˆ SQLx ç¼“å­˜ï¼Œè¯·é€‰æ‹©: ğŸ“¦ é‡æ–°ç”Ÿæˆ SQLx ç¼“å­˜' -ForegroundColor Yellow; exit 1 } else { Write-Host '[OK] SQLx ç¼“å­˜å·²å­˜åœ¨' -ForegroundColor Green }; Write-Host 'æ¸…ç©ºæ‰€æœ‰æ•°æ®å’Œå®¹å™¨...' -ForegroundColor Yellow; docker compose -f docker-compose-dev.yml --env-file .env down -v; Write-Host 'é‡æ–°ç¼–è¯‘å¹¶å¯åŠ¨æ ¸å¿ƒæœåŠ¡ (ä¸å« AI)...' -ForegroundColor Cyan; docker compose -f docker-compose-dev.yml --env-file .env up -d --build postgres redis minio gotrue appflowy_cloud nginx; if ($LASTEXITCODE -eq 0) { Write-Host 'æœåŠ¡å¯åŠ¨æˆåŠŸï¼' -ForegroundColor Green; Write-Host 'è®¿é—®: http://localhost:8000/health' -ForegroundColor Cyan; Write-Host 'å·²æ’é™¤: AI æœåŠ¡, PgAdmin' -ForegroundColor Gray } else { Write-Host 'å¯åŠ¨å¤±è´¥ï¼ŒæŸ¥çœ‹æ—¥å¿—: docker compose -f docker-compose-dev.yml logs' -ForegroundColor Red }"
            ],
            "console": "integratedTerminal",
            "internalConsoleOptions": "neverOpen"
        },
        {
            "name": "ğŸ“¦ é‡æ–°ç”Ÿæˆ SQLx ç¼“å­˜",
            "type": "node",
            "request": "launch",
            "runtimeExecutable": "powershell.exe",
            "runtimeArgs": [
                "-NoProfile",
                "-ExecutionPolicy",
                "Bypass",
                "-Command",
                "$ErrorActionPreference = 'Continue'; Write-Host '======================================' -ForegroundColor Cyan; Write-Host '  é‡æ–°ç”Ÿæˆ SQLx ç¼“å­˜' -ForegroundColor Cyan; Write-Host '======================================' -ForegroundColor Cyan; Write-Host ''; Write-Host 'æ£€æŸ¥ Rust/Cargo...' -ForegroundColor Cyan; try { $rustVersion = cargo --version; if ($LASTEXITCODE -ne 0) { throw 'Cargo not found' }; Write-Host \"[OK] $rustVersion\" -ForegroundColor Green } catch { Write-Host '[é”™è¯¯] æœªæ‰¾åˆ° Rust/Cargo' -ForegroundColor Red; Write-Host 'è¯·å®‰è£… Rust: https://rustup.rs/' -ForegroundColor Yellow; exit 1 }; Write-Host ''; Write-Host 'æ£€æŸ¥ sqlx-cli...' -ForegroundColor Cyan; try { $null = cargo sqlx --version 2>&1; if ($LASTEXITCODE -ne 0) { throw } } catch { Write-Host '[æç¤º] æ­£åœ¨å®‰è£… sqlx-cli...' -ForegroundColor Yellow; cargo install sqlx-cli --no-default-features --features postgres; if ($LASTEXITCODE -ne 0) { Write-Host '[é”™è¯¯] sqlx-cli å®‰è£…å¤±è´¥' -ForegroundColor Red; exit 1 } }; Write-Host '[OK] sqlx-cli å·²å°±ç»ª' -ForegroundColor Green; Write-Host ''; Write-Host 'å¯åŠ¨ PostgreSQL...' -ForegroundColor Cyan; docker compose -f docker-compose-dev.yml up -d postgres; Write-Host 'ç­‰å¾… PostgreSQL å°±ç»ª...' -ForegroundColor Yellow; Start-Sleep -Seconds 3; Write-Host ''; Write-Host 'åˆ›å»º auth schema...' -ForegroundColor Cyan; $oldErrorPref = $ErrorActionPreference; $ErrorActionPreference = 'SilentlyContinue'; docker exec ponynotes-cloud-new-postgres-1 psql -U postgres -d postgres -tAc 'CREATE SCHEMA IF NOT EXISTS auth' 2>&1 | Out-Null; $ErrorActionPreference = $oldErrorPref; Write-Host '[OK] auth schema å·²åˆ›å»º' -ForegroundColor Green; Write-Host ''; Write-Host 'å¯åŠ¨ GoTrue...' -ForegroundColor Cyan; docker compose -f docker-compose-dev.yml up -d gotrue; Write-Host 'ç­‰å¾… GoTrue åˆå§‹åŒ–...' -ForegroundColor Yellow; $maxRetries = 15; $retryCount = 0; $gotrueReady = 0; while ($retryCount -lt $maxRetries -and $gotrueReady -eq 0) { Start-Sleep -Seconds 2; $retryCount++; Write-Host \"æ£€æŸ¥ GoTrue ($retryCount/$maxRetries)...\" -ForegroundColor Gray; $containerStatus = docker ps --filter name=ponynotes-cloud-new-gotrue-1 --filter status=running --format '{{.Status}}' 2>&1 | Out-String; if ($containerStatus -match 'Up') { $gotrueReady = 1; Write-Host '[OK] GoTrue å·²å¯åŠ¨' -ForegroundColor Green } }; if ($gotrueReady -eq 0) { Write-Host '[è­¦å‘Š] GoTrue å¯åŠ¨è¶…æ—¶ï¼Œç»§ç»­æ‰§è¡Œ...' -ForegroundColor Yellow }; Write-Host ''; Write-Host 'åŠ è½½ç¯å¢ƒå˜é‡...' -ForegroundColor Cyan; if (Test-Path 'dev.env') { Get-Content 'dev.env' | ForEach-Object { if ($_ -match '^([^#][^=]+)=(.*)$') { $name = $matches[1].Trim(); $value = $matches[2].Trim(); [Environment]::SetEnvironmentVariable($name, $value) } } } else { [Environment]::SetEnvironmentVariable('DATABASE_URL', 'postgres://postgres:password@localhost:5432/postgres') }; Write-Host ''; Write-Host 'è¿è¡Œæ•°æ®åº“è¿ç§»...' -ForegroundColor Cyan; cargo sqlx migrate run; if ($LASTEXITCODE -ne 0) { Write-Host '[é”™è¯¯] æ•°æ®åº“è¿ç§»å¤±è´¥' -ForegroundColor Red; exit 1 }; Write-Host '[OK] è¿ç§»å®Œæˆ' -ForegroundColor Green; Write-Host ''; Write-Host 'ç”Ÿæˆ SQLx ç¼“å­˜æ–‡ä»¶...' -ForegroundColor Cyan; Write-Host '(è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿ...)' -ForegroundColor Yellow; cargo sqlx prepare --workspace; if ($LASTEXITCODE -ne 0) { Write-Host '[é”™è¯¯] SQLx ç¼“å­˜ç”Ÿæˆå¤±è´¥' -ForegroundColor Red; exit 1 }; Write-Host ''; Write-Host '======================================' -ForegroundColor Green; Write-Host '  SQLx ç¼“å­˜ç”ŸæˆæˆåŠŸï¼' -ForegroundColor Green; Write-Host '======================================' -ForegroundColor Green; Write-Host ''; Write-Host 'ç°åœ¨å¯ä»¥è¿è¡Œ: ğŸš€ é‡æ–°ç¼–è¯‘å¹¶å¯åŠ¨' -ForegroundColor Cyan; Write-Host ''"
            ],
            "console": "integratedTerminal",
            "internalConsoleOptions": "neverOpen"
        },
        {
            "name": "ğŸ“‹ æŸ¥çœ‹æœåŠ¡æ—¥å¿—",
            "type": "node",
            "request": "launch",
            "runtimeExecutable": "powershell.exe",
            "runtimeArgs": [
                "-NoProfile",
                "-ExecutionPolicy",
                "Bypass",
                "-Command",
                "Write-Host 'æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿— (Ctrl+C é€€å‡º)...' -ForegroundColor Cyan; Write-Host ''; docker compose -f docker-compose-dev.yml --env-file .env logs -f"
            ],
            "console": "integratedTerminal",
            "internalConsoleOptions": "neverOpen"
        },
        {
            "name": "ğŸ›‘ åœæ­¢æ‰€æœ‰æœåŠ¡",
            "type": "node",
            "request": "launch",
            "runtimeExecutable": "powershell.exe",
            "runtimeArgs": [
                "-NoProfile",
                "-ExecutionPolicy",
                "Bypass",
                "-Command",
                "Write-Host 'åœæ­¢æ‰€æœ‰æœåŠ¡...' -ForegroundColor Cyan; docker compose -f docker-compose-dev.yml --env-file .env down; if ($LASTEXITCODE -eq 0) { Write-Host '[OK] æ‰€æœ‰æœåŠ¡å·²åœæ­¢' -ForegroundColor Green } else { Write-Host '[é”™è¯¯] åœæ­¢å¤±è´¥' -ForegroundColor Red }"
            ],
            "console": "integratedTerminal",
            "internalConsoleOptions": "neverOpen"
        },
        {
            "name": "ğŸ“Š æŸ¥çœ‹æœåŠ¡çŠ¶æ€",
            "type": "node",
            "request": "launch",
            "runtimeExecutable": "powershell.exe",
            "runtimeArgs": [
                "-NoProfile",
                "-ExecutionPolicy",
                "Bypass",
                "-Command",
                "Write-Host 'Docker æœåŠ¡çŠ¶æ€:' -ForegroundColor Cyan; Write-Host ''; docker compose -f docker-compose-dev.yml --env-file .env ps; Write-Host ''; Write-Host 'å¥åº·æ£€æŸ¥:' -ForegroundColor Cyan; try { $response = Invoke-WebRequest -Uri 'http://localhost:8000/health' -UseBasicParsing -TimeoutSec 3; Write-Host '[OK] AppFlowy Cloud: è¿è¡Œä¸­' -ForegroundColor Green } catch { Write-Host '[X] AppFlowy Cloud: æœªå“åº”' -ForegroundColor Red }; try { $response = Invoke-WebRequest -Uri 'http://localhost:9999/health' -UseBasicParsing -TimeoutSec 3; Write-Host '[OK] GoTrue: è¿è¡Œä¸­' -ForegroundColor Green } catch { Write-Host '[X] GoTrue: æœªå“åº”' -ForegroundColor Red }"
            ],
            "console": "integratedTerminal",
            "internalConsoleOptions": "neverOpen"
        }
    ]
}
